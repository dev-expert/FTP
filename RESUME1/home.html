<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scal
    e=1.0">
    <title>Document</title>
    <!-- <link rel="stylesheet" href="styles.css"> -->
    <!-- <script src="indx.js"></script> -->
    <style>
        body {

            height: 100vh;
            background-size: cover;
            background-position: center;
        }

        .login-page {
            width: 360px;
            padding: 10% 0 0;
            margin: auto;

        }

        .form {
            position: relative;
            z-index: 1;
            background: rgba(126, 147, 238, 0.8);
            max-width: 360px;
            margin: 0 auto 100px;
            padding: 45px;
            text-align: center;
        }

        .form input {
            font-family: "Roboto", sans-serif;
            outline: 1;
            background: #f2f2f2;
            width: 100%;
            border: 0;
            margin: 0 0 15px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 14px;
        }



        .form button {
            font-family: "Roboto", sans-serif;
            text-transform: uppercase;
            outline: 0;
            padding: 15px;
            color: #ffff;
            background-color: #43A047;
            font-size: 14px;
            cursor: pointer;
        }

        .form button:hover {
            background: rgb(170, 241, 111);
            /* , .form button:active */
        }

        .form .message {
            margin: 15px 0 0;
            color: aliceblue;
            font-size: 12px;
        }

        .form .message a {
            color: #43A047;
            text-decoration: none;
        }

        .form .register-form {
            display: none;
        }
    </style>
</head>

<body background="img1.jpg">
    <div class="login-page">
        <div class="form">
            <form class="register-form">

                <input type="text" placeholder="USERNAME" id="x" />

                <input type="password" id="a" placeholder="PASSWORD" />
                <input type="password" id="b" placeholder="CONFORM PASSWORD" />
                <input type="text" id="c" placeholder="EMAIL" />
                <input type="text" id="d" placeholder="PHONE NUMBER" />




                <div style="text-align: left;"><label for="text">CHOOSE:</label>

                    <select name="text" id="e">
                        <option value="true" id="admin">ADMIN</option>
                        <option value="false" id="normal user">NORMAL USER</option>
                    </select>
                </div>
                <br>
                <button type="submit" onclick="Register()">Create</button>
                <p class="message">Already Registered?<a href="#">Login</a></p>

            </form>
            <form class="Login-form">
                <input type="text" id="r" placeholder="EMAIL" />
                <input type="password" id="f" placeholder="PASSWORD" />
                <button onclick="Login()">Login</button>
                <p class="message">Not Registered? <a href="#">Register</a></p>
            </form>
        </div>
    </div>
    <script src="https://code.jquery.com/jquery-3.5.1.min.js">
    </script>

    <script>
        $('.message a').click(function () {
            $('form').animate({ height: "toggle", opacity: "toggle" }, "slow");
        });

        function Register() {
            var usn = document.getElementById("x").value;
            var password = document.getElementById('a').value;
            var conformpassword = document.getElementById('b').value;
            var email = document.getElementById('c').value;
            var phonenumber = document.getElementById('d').value;
            var admin = document.getElementById('e').value;

            if (password == conformpassword) {


                var users = {
                    username: usn,
                    password: password,
                    conformpassword: conformpassword,
                    email: email,
                    phonenumber: phonenumber,
                    admin: admin
                };

                fetch('http://localhost:5000/exportdata', {
                    method: 'POST',
                    body: JSON.stringify(users),
                    headers: {
                        "Content-Type": "application/json",
                    },
                    body: JSON.stringify(users),
                })
                    .then(response => response.json())
                    .then(data => console.log(data))
                    .catch(err => console.error(err));

                //     var old = JSON.parse(localStorage.getItem("users"));
                //     if (!old) {
                //         old = [];
                //     }
                //     if (old.find(x => x.email === email)) {
                //         alert("Present");
                //     }
                //     else {
                //         old.push(users);
                //     }
                //     localStorage.setItem("users", JSON.stringify(old));
                //     window.open("home.html");

                // }
                // else {
                //     alert("password and conform password not match");
                // }
            }
        }



        function Login() {
            var pass1 = document.getElementById("f").value;
            var mail2 = document.getElementById("r").value;

            var person = JSON.parse(localStorage.getItem("users"));
            for (i = 0; i < person.length; i++) {
                s = person[i];
                if (s.email === mail2 && s.password == pass1) {
                    if (s.admin == "true") {
                        var currentuserobj = {
                            email: s.email,
                            password: s.password
                        };
                        currentuser = [];
                        currentuser.push(currentuserobj);
                        localStorage.setItem("presentuser", JSON.stringify(currentuser));
                        window.open("table.html");
                        break;
                    }

                    else {

                        window.open("index1.html");
                        break;
                    }

                }

            }
        }
    </script>
</body>

</html>