<html>
  <head>
    <title> </title>
  </head>
  <body onload="validate()">
    <a href="./urllog/urllog.html">URLLOG</a>
    <a href="./calculator.html">Calculator</a>
    <a href="./CV/cv.html">Resume Builder</a>
    Welcome to Admin Page

    <!-- <table id="table" border="1">
           <tr>
               <td>
                   Email
               </td>
               <td>
                   Password
               </td>
               isadmin
            <td>
                Delete
            </td>
           </tr>
       </table>
        -->
     <!-- <a href="./urllog/urllog.html">URLLOG</a>    -->
    <button onclick="users()">Show table</button>
    <button onclick="logout()">LogOUT</button>
    <table border="1">
      <thead>
        <tr>
          <th>Name</th>
          <th>Email</th>
          <th>usertype</th>
          <th>Delete user</th>
          <th>
            <button onclick="deletetick(gettick('tickdata'))">
              Delete Users
            </button>
          </th>
        </tr>
      </thead>
      <tbody id="displayallusers"></tbody>
    </table>
    <br>
    
    <script>
      //     var info = document.getElementById("table");
      //     for (var i = 0; i < localStorage.length; i++){
      // var user = JSON.parse(localStorage.getItem(localStorage.key(i)));
      // info.innerHTML += "<tr id= " + i + "><td>" + user.email + "</td><td>" + user.pass + "</td><td>" + user.isadmin + "</td><td>";
      function users() {
        var keys = JSON.parse(localStorage.getItem("users"));
        var str = "";
        for (i = 0; i < keys.length; i++) {
          s = keys[i];
          str += `<tr>
          <td>${s.pass}</td>
          <td>${s.email}</td>
          <td><input type="checkbox" name="tickdata" value="${s.email}"><button onclick="deleteuser('${s.email}')">Delete</button></td>
          </tr>`;
        }
        document.getElementById("displayallusers").innerHTML = str;
      }
      function deleteuser(semail) {
        let keys = JSON.parse(localStorage.getItem("users"));
        for (i = 0; i < keys.length; i++) {
          s = keys[i];
          if (semail === s.email) {
            keys.splice(i, 1);
          }
        }
        localStorage.setItem("users", JSON.stringify(keys));
        users();
      }
      function deletetick(keys1) {
        let keys = JSON.parse(localStorage.getItem("users"));
        for (i = 0; i < keys1.length; i++) {
          for (j = 0; j < keys.length; j++) {
            s = keys[j];
            if (keys1[i] === s.email) {
              keys.splice(j, 1);
            }
          }
        }
        localStorage.setItem("users", JSON.stringify(keys));
        users();
      }
      function gettick(semail) {
        const c = document.querySelectorAll(`input[name="${semail}"]:checked`);
        let drr = [];
        c.forEach((c) => {
          drr.push(c.value);
          console.log(c.value);
        });
        return drr;
      }
      function validate() {
        var sam = JSON.parse(localStorage.getItem("presentuser"));
        if (sam == null) {
          window.open("login.html");
        }
      }

      
      function logout() {
        localStorage.removeItem("presentuser");
        location.reload();
      }
    </script>
  </body>
</html>
